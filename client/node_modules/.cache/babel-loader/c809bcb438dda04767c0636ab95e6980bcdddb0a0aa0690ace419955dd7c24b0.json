{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Link,useNavigate}from'react-router-dom';import{Badge}from'react-bootstrap';import api from'../utils/api';import SearchUsers from'./SearchUsers';import Logo from'./Logo';import'./Navbar.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const Navbar=()=>{const navigate=useNavigate();const token=localStorage.getItem('token');const[unreadRequests,setUnreadRequests]=useState(0);useEffect(()=>{if(token){fetchUnreadRequests();}},[token]);const fetchUnreadRequests=async()=>{try{const response=await api.get('/api/audio-requests/my-orders');// Get viewed requests from localStorage\nconst storedViewedRequests=localStorage.getItem('viewedRequests');const viewedRequests=storedViewedRequests?new Set(JSON.parse(storedViewedRequests)):new Set();// Count unread pending requests\nconst unreadCount=response.data.filter(req=>!viewedRequests.has(req._id)&&req.status==='pending').length;setUnreadRequests(unreadCount);}catch(err){console.error('Error fetching unread requests:',err);}};const handleLogout=()=>{localStorage.removeItem('token');localStorage.removeItem('userId');navigate('/login');};return/*#__PURE__*/_jsxs(\"nav\",{className:\"navbar\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"navbar-left\",children:/*#__PURE__*/_jsx(Logo,{className:\"navbar-brand\"})}),token&&/*#__PURE__*/_jsx(\"div\",{className:\"navbar-search\",children:/*#__PURE__*/_jsx(SearchUsers,{})}),/*#__PURE__*/_jsxs(\"div\",{className:\"navbar-links\",children:[!token&&/*#__PURE__*/_jsx(Link,{to:\"/login\",children:\"Login\"}),token&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Link,{to:\"/upload\",children:\"Send Audio\"}),/*#__PURE__*/_jsx(Link,{to:\"/audio-history\",children:\"My Audio\"}),/*#__PURE__*/_jsxs(Link,{to:\"/requests\",className:\"requests-link\",children:[\"Requests\",unreadRequests>0&&/*#__PURE__*/_jsx(Badge,{pill:true,bg:\"danger\",className:\"unread-badge\",children:unreadRequests})]}),/*#__PURE__*/_jsx(Link,{to:\"/profile\",children:\"My Profile\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleLogout,className:\"logout-button\",children:\"Logout\"})]})]})]});};export default Navbar;","map":{"version":3,"names":["React","useState","useEffect","Link","useNavigate","Badge","api","SearchUsers","Logo","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Navbar","navigate","token","localStorage","getItem","unreadRequests","setUnreadRequests","fetchUnreadRequests","response","get","storedViewedRequests","viewedRequests","Set","JSON","parse","unreadCount","data","filter","req","has","_id","status","length","err","console","error","handleLogout","removeItem","className","children","to","pill","bg","onClick"],"sources":["/Users/davidmcguire/Desktop/Master/Cursor/AudioZoom/client/src/components/Navbar.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Link, useNavigate } from 'react-router-dom';\nimport { Badge } from 'react-bootstrap';\nimport api from '../utils/api';\nimport SearchUsers from './SearchUsers';\nimport Logo from './Logo';\nimport './Navbar.css';\n\nconst Navbar = () => {\n  const navigate = useNavigate();\n  const token = localStorage.getItem('token');\n  const [unreadRequests, setUnreadRequests] = useState(0);\n\n  useEffect(() => {\n    if (token) {\n      fetchUnreadRequests();\n    }\n  }, [token]);\n\n  const fetchUnreadRequests = async () => {\n    try {\n      const response = await api.get('/api/audio-requests/my-orders');\n      \n      // Get viewed requests from localStorage\n      const storedViewedRequests = localStorage.getItem('viewedRequests');\n      const viewedRequests = storedViewedRequests ? new Set(JSON.parse(storedViewedRequests)) : new Set();\n      \n      // Count unread pending requests\n      const unreadCount = response.data.filter(\n        req => !viewedRequests.has(req._id) && req.status === 'pending'\n      ).length;\n      \n      setUnreadRequests(unreadCount);\n    } catch (err) {\n      console.error('Error fetching unread requests:', err);\n    }\n  };\n\n  const handleLogout = () => {\n    localStorage.removeItem('token');\n    localStorage.removeItem('userId');\n    navigate('/login');\n  };\n\n  return (\n    <nav className=\"navbar\">\n      <div className=\"navbar-left\">\n        <Logo className=\"navbar-brand\" />\n      </div>\n      \n      {token && (\n        <div className=\"navbar-search\">\n          <SearchUsers />\n        </div>\n      )}\n      \n      <div className=\"navbar-links\">\n        {!token && (\n          <Link to=\"/login\">Login</Link>\n        )}\n        {token && (\n          <>\n            <Link to=\"/upload\">Send Audio</Link>\n            <Link to=\"/audio-history\">My Audio</Link>\n            <Link to=\"/requests\" className=\"requests-link\">\n              Requests\n              {unreadRequests > 0 && (\n                <Badge pill bg=\"danger\" className=\"unread-badge\">\n                  {unreadRequests}\n                </Badge>\n              )}\n            </Link>\n            <Link to=\"/profile\">My Profile</Link>\n            <button onClick={handleLogout} className=\"logout-button\">Logout</button>\n          </>\n        )}\n      </div>\n    </nav>\n  );\n};\n\nexport default Navbar; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}